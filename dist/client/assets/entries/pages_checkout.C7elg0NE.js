import{P as u,t as l,r as k,c as M,j as o,n as V,d as be,C as Se,i as je,a as Ee,b as we}from"../chunks/chunk-uGg6OmiJ.js";import"../chunks/chunk-eJmAJtGH.js";import{j as ke}from"../chunks/chunk-VWaDGczM.js";function Y(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(r,a).enumerable})),t.push.apply(t,n)}return t}function G(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Y(Object(t),!0).forEach(function(n){te(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Y(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function _(r){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?_=function(e){return typeof e}:_=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_(r)}function te(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function re(r,e){return Pe(r)||Ne(r,e)||Te(r,e)||Ae()}function Pe(r){if(Array.isArray(r))return r}function Ne(r,e){var t=r&&(typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"]);if(t!=null){var n=[],a=!0,s=!1,d,m;try{for(t=t.call(r);!(a=(d=t.next()).done)&&(n.push(d.value),!(e&&n.length===e));a=!0);}catch(i){s=!0,m=i}finally{try{!a&&t.return!=null&&t.return()}finally{if(s)throw m}}return n}}function Te(r,e){if(r){if(typeof r=="string")return J(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return J(r,e)}}function J(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}function Ae(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var C=function(e,t,n){var a=!!n,s=l.useRef(n);l.useEffect(function(){s.current=n},[n]),l.useEffect(function(){if(!a||!e)return function(){};var d=function(){s.current&&s.current.apply(s,arguments)};return e.on(t,d),function(){e.off(t,d)}},[a,t,e,s])},B=function(e){var t=l.useRef(e);return l.useEffect(function(){t.current=e},[e]),t.current},P=function(e){return e!==null&&_(e)==="object"},Oe=function(e){return P(e)&&typeof e.then=="function"},Re=function(e){return P(e)&&typeof e.elements=="function"&&typeof e.createToken=="function"&&typeof e.createPaymentMethod=="function"&&typeof e.confirmCardPayment=="function"},K="[object Object]",Ue=function r(e,t){if(!P(e)||!P(t))return e===t;var n=Array.isArray(e),a=Array.isArray(t);if(n!==a)return!1;var s=Object.prototype.toString.call(e)===K,d=Object.prototype.toString.call(t)===K;if(s!==d)return!1;if(!s&&!n)return e===t;var m=Object.keys(e),i=Object.keys(t);if(m.length!==i.length)return!1;for(var b={},y=0;y<m.length;y+=1)b[m[y]]=!0;for(var v=0;v<i.length;v+=1)b[i[v]]=!0;var h=Object.keys(b);if(h.length!==m.length)return!1;var c=e,S=t,x=function(A){return r(c[A],S[A])};return h.every(x)},ne=function(e,t,n){return P(e)?Object.keys(e).reduce(function(a,s){var d=!P(t)||!Ue(e[s],t[s]);return n.includes(s)?(d&&console.warn("Unsupported prop change: options.".concat(s," is not a mutable property.")),a):d?G(G({},a||{}),{},te({},s,e[s])):a},null):null},oe="Invalid prop `stripe` supplied to `Elements`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.",X=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:oe;if(e===null||Re(e))return e;throw new Error(t)},Le=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:oe;if(Oe(e))return{tag:"async",stripePromise:Promise.resolve(e).then(function(a){return X(a,t)})};var n=X(e,t);return n===null?{tag:"empty"}:{tag:"sync",stripe:n}},Ie=function(e){!e||!e._registerWrapper||!e.registerAppInfo||(e._registerWrapper({name:"react-stripe-js",version:"2.7.2"}),e.registerAppInfo({name:"react-stripe-js",version:"2.7.2",url:"https://stripe.com/docs/stripe-js/react"}))},z=l.createContext(null);z.displayName="ElementsContext";var ae=function(e,t){if(!e)throw new Error("Could not find Elements context; You need to wrap the part of your app that ".concat(t," in an <Elements> provider."));return e},se=function(e){var t=e.stripe,n=e.options,a=e.children,s=l.useMemo(function(){return Le(t)},[t]),d=l.useState(function(){return{stripe:s.tag==="sync"?s.stripe:null,elements:s.tag==="sync"?s.stripe.elements(n):null}}),m=re(d,2),i=m[0],b=m[1];l.useEffect(function(){var h=!0,c=function(x){b(function(j){return j.stripe?j:{stripe:x,elements:x.elements(n)}})};return s.tag==="async"&&!i.stripe?s.stripePromise.then(function(S){S&&h&&c(S)}):s.tag==="sync"&&!i.stripe&&c(s.stripe),function(){h=!1}},[s,i,n]);var y=B(t);l.useEffect(function(){y!==null&&y!==t&&console.warn("Unsupported prop change on Elements: You cannot change the `stripe` prop after setting it.")},[y,t]);var v=B(n);return l.useEffect(function(){if(i.elements){var h=ne(n,v,["clientSecret","fonts"]);h&&i.elements.update(h)}},[n,v,i.elements]),l.useEffect(function(){Ie(i.stripe)},[i.stripe]),l.createElement(z.Provider,{value:i},a)};se.propTypes={stripe:u.any,options:u.object};var _e=function(e){var t=l.useContext(z);return ae(t,e)},ze=function(){var e=_e("calls useElements()"),t=e.elements;return t};u.func.isRequired;var ie=l.createContext(null);ie.displayName="CustomCheckoutSdkContext";var De=function(e,t){if(!e)throw new Error("Could not find CustomCheckoutProvider context; You need to wrap the part of your app that ".concat(t," in an <CustomCheckoutProvider> provider."));return e},qe=l.createContext(null);qe.displayName="CustomCheckoutContext";u.any,u.shape({clientSecret:u.string.isRequired,elementsOptions:u.object}).isRequired;var W=function(e){var t=l.useContext(ie),n=l.useContext(z);if(t&&n)throw new Error("You cannot wrap the part of your app that ".concat(e," in both <CustomCheckoutProvider> and <Elements> providers."));return t?De(t,e):ae(n,e)},Be=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},p=function(e,t){var n="".concat(Be(e),"Element"),a=function(i){var b=i.id,y=i.className,v=i.options,h=v===void 0?{}:v,c=i.onBlur,S=i.onFocus,x=i.onReady,j=i.onChange,A=i.onEscape,de=i.onClick,pe=i.onLoadError,fe=i.onLoaderStart,me=i.onNetworksChange,he=i.onConfirm,ve=i.onCancel,ge=i.onShippingAddressChange,ye=i.onShippingRateChange,O=W("mounts <".concat(n,">")),R="elements"in O?O.elements:null,U="customCheckoutSdk"in O?O.customCheckoutSdk:null,xe=l.useState(null),F=re(xe,2),g=F[0],Ce=F[1],w=l.useRef(null),D=l.useRef(null);C(g,"blur",c),C(g,"focus",S),C(g,"escape",A),C(g,"click",de),C(g,"loaderror",pe),C(g,"loaderstart",fe),C(g,"networkschange",me),C(g,"confirm",he),C(g,"cancel",ve),C(g,"shippingaddresschange",ge),C(g,"shippingratechange",ye),C(g,"change",j);var q;x&&(e==="expressCheckout"?q=x:q=function(){x(g)}),C(g,"ready",q),l.useLayoutEffect(function(){if(w.current===null&&D.current!==null&&(R||U)){var E=null;U?E=U.createElement(e,h):R&&(E=R.create(e,h)),w.current=E,Ce(E),E&&E.mount(D.current)}},[R,U,h]);var $=B(h);return l.useEffect(function(){if(w.current){var E=ne(h,$,["paymentRequest"]);E&&w.current.update(E)}},[h,$]),l.useLayoutEffect(function(){return function(){if(w.current&&typeof w.current.destroy=="function")try{w.current.destroy(),w.current=null}catch{}}},[]),l.createElement("div",{id:b,className:y,ref:D})},s=function(i){W("mounts <".concat(n,">"));var b=i.id,y=i.className;return l.createElement("div",{id:b,className:y})},d=t?s:a;return d.propTypes={id:u.string,className:u.string,onChange:u.func,onBlur:u.func,onFocus:u.func,onReady:u.func,onEscape:u.func,onClick:u.func,onLoadError:u.func,onLoaderStart:u.func,onNetworksChange:u.func,onConfirm:u.func,onCancel:u.func,onShippingAddressChange:u.func,onShippingRateChange:u.func,options:u.object},d.displayName=n,d.__elementType=e,d},f=typeof window>"u",We=l.createContext(null);We.displayName="EmbeddedCheckoutProviderContext";var Me=function(){var e=W("calls useStripe()"),t=e.stripe;return t};p("auBankAccount",f);var H=p("card",f);p("cardNumber",f);p("cardExpiry",f);p("cardCvc",f);p("fpxBank",f);p("iban",f);p("idealBank",f);p("p24Bank",f);p("epsBank",f);p("payment",f);p("expressCheckout",f);p("paymentRequestButton",f);p("linkAuthentication",f);p("address",f);p("shippingAddress",f);p("paymentMethodMessaging",f);p("affirmMessage",f);p("afterpayClearpayMessage",f);var le="https://js.stripe.com/v3",Fe=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,Q="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",$e=function(){for(var e=document.querySelectorAll('script[src^="'.concat(le,'"]')),t=0;t<e.length;t++){var n=e[t];if(Fe.test(n.src))return n}return null},Z=function(e){var t="",n=document.createElement("script");n.src="".concat(le).concat(t);var a=document.head||document.body;if(!a)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return a.appendChild(n),n},Ve=function(e,t){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"4.0.0",startTime:t})},N=null,L=null,I=null,Ye=function(e){return function(){e(new Error("Failed to load Stripe.js"))}},Ge=function(e,t){return function(){window.Stripe?e(window.Stripe):t(new Error("Stripe.js not available"))}},Je=function(e){return N!==null?N:(N=new Promise(function(t,n){if(typeof window>"u"||typeof document>"u"){t(null);return}if(window.Stripe&&e&&console.warn(Q),window.Stripe){t(window.Stripe);return}try{var a=$e();if(a&&e)console.warn(Q);else if(!a)a=Z(e);else if(a&&I!==null&&L!==null){var s;a.removeEventListener("load",I),a.removeEventListener("error",L),(s=a.parentNode)===null||s===void 0||s.removeChild(a),a=Z(e)}I=Ge(t,n),L=Ye(n),a.addEventListener("load",I),a.addEventListener("error",L)}catch(d){n(d);return}}),N.catch(function(t){return N=null,Promise.reject(t)}))},Ke=function(e,t,n){if(e===null)return null;var a=e.apply(void 0,t);return Ve(a,n),a},T,ce=!1,ue=function(){return T||(T=Je(null).catch(function(e){return T=null,Promise.reject(e)}),T)};Promise.resolve().then(function(){return ue()}).catch(function(r){ce||console.warn(r)});var Xe=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];ce=!0;var a=Date.now();return ue().then(function(s){return Ke(s,t,a)})};const He=()=>{const[r,e]=k.useState(!1);return k.useEffect(()=>{r||e(!0)},[r]),r},Qe={style:{base:{fontSize:"32px",color:"#52a635","::placeholder":{color:"#aab7c4"}},invalid:{color:"#9e2521"}}},ee={address:"",city:"",state:"",pincode:"",error:null},Ze=()=>{const[r,e]=k.useState(ee),[t,n]=k.useState(!1),[a,s]=k.useState(null),{user:d,cart:m,resetCart:i}=M(),b=Me(),y=ze();k.useEffect(()=>{if(typeof window.localStorage<"u"){const c=localStorage.getItem("token");c&&(console.log(ke(c),"token_1231"),s(c))}},[]);const v=c=>{const S=r[c.target.name]=c.target.value;e({...r,updateItem:S})},h=async c=>{c.preventDefault();const S=y.getElement(H),x=await b.createToken(S);if(r.address===""){e({...r,error:{message:"Address is required"}});return}if(r.city===""){e({...r,error:{message:"City is required"}});return}if(r.state===""){e({...r,error:{message:"State is required"}});return}if(r.pincode===""){e({...r,error:{message:"Pin Code is required"}});return}if(x.error){e({...r,error:{message:x.error.message}});return}try{n(!0),console.log(x,"token_stripe");const j=await be.post("/api/orders/create",{data:{amount:m.total,items:m.items,address:r.address,city:r.city,state:r.state,pincode:r.pincode,token:x.token.id},token:a});console.log(j,"response_ewt"),j.data.createOrder.data&&(alert("Transaction Successful, continue your shopping"),e(ee),i(),V("/"))}catch(j){console.log("error===>",j),e({...r,error:{message:j.message}})}finally{n(!1)}};return o.jsx(k.Fragment,{children:o.jsx("form",{children:o.jsxs("div",{className:"bg-white shadow-md rounded-lg p-8",children:[o.jsx("h5",{className:"text-lg font-semibold",children:"Your information:"}),o.jsx("hr",{className:"my-4"}),o.jsx("div",{className:"flex mb-6",children:o.jsxs("div",{className:"flex-1",children:[o.jsx("label",{className:"block mb-2 test-gray-800 font-medium",htmlFor:"address",children:"Address"}),o.jsx("input",{id:"address",htmlFor:"address",className:"appearance-none block w-full p-3 leading-5 text-gray-900 border border-gray-200 rounded-lg shadow-md placeholder-text-gray-400 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50",type:"text",name:"address",onChange:c=>v(c),placeholder:"Enter your address"})]})}),o.jsxs("div",{className:"flex mb-6",children:[o.jsxs("div",{className:"flex-1 mr-6",children:[o.jsx("label",{htmlFor:"city",className:"block mb-2 test-gray-800 font-medium",children:"City"}),o.jsx("input",{type:"text",name:"city",id:"city",onChange:c=>v(c),className:"appearance-none block w-full p-3 leading-5 text-gray-900 border border-gray-200 rounded-lg shadow-md placeholder-text-gray-400 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50"})]}),o.jsxs("div",{className:" flex flex-row gap-2 w-1/2",children:[o.jsxs("div",{className:"w-1/2",children:[o.jsx("label",{htmlFor:"state",className:"block mb-2 test-gray-800 font-medium",children:"State"}),o.jsx("input",{type:"text",name:"state",id:"state",onChange:c=>v(c),className:"appearance-none block w-full p-3 leading-5 text-gray-900 border border-gray-200 rounded-lg shadow-md placeholder-text-gray-400 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50"})]}),o.jsxs("div",{className:"w-1/2",children:[o.jsx("label",{htmlFor:"state",className:"block mb-2 test-gray-800 font-medium",children:"Pin Code"}),o.jsx("input",{type:"number",name:"pincode",id:"pincode",onChange:c=>v(c),className:"appearance-none block w-full p-3 leading-5 text-gray-900 border border-gray-200 rounded-lg shadow-md placeholder-text-gray-400 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50"})]})]})]}),m.items.length>0?o.jsxs("div",{className:"p-6",children:[o.jsx("div",{children:"Credit or debit card"}),o.jsx("div",{className:"my-4",children:o.jsx(H,{options:Qe})}),o.jsx("button",{className:"inline-block w-full px-6 py-3 text-center font-bold text-white bg-green-500 hover:bg-green-600 transition duration-200 rounded-full",onClick:c=>d?h(c):V("/auth/sign-in"),disabled:t,children:t?"Submitting":"Submit Order"})]}):o.jsxs("div",{className:"text-center",children:[o.jsx("h1",{className:"text-2xl font-semibold",children:"Your cart is empty"}),o.jsx("p",{className:"text-gray-500",children:"Add some items to your cart to continue"})]}),o.jsx("div",{children:r.error&&o.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",children:[o.jsx("strong",{className:"font-bold",children:"Error!"})," ",o.jsx("span",{className:"block sm:inline",children:r.error.message})]})})]})})})},et=r=>{const{cart:e}=M(),{displayTotal:t}=r;return o.jsx("div",{className:"rounded-2xl bg-gray-800 z-40",children:o.jsxs("div",{className:"max-w-lg pt-6 pb-8 px-8 mx-auto bg-blueGray-900",children:[o.jsx("div",{className:"flex mb-10 items-center justify-between",children:o.jsx("h6",{className:"font-bold text-2xl text-white mb-0",children:"Your Cart"})}),o.jsx("div",{children:e.items?e.items.map((n,a)=>{if(n.quantity>0)return o.jsx(Se,{data:n},a)}):null}),o.jsx("div",{className:"p-6",children:o.jsxs("div",{className:"flex mb-6 content-center justify-between",children:[o.jsx("span",{className:"font-bold text-white",children:"Order total"}),o.jsxs("span",{className:"text-sm font-bold text-white",children:["₹",t]})]})})]})})},tt=Xe("pk_test_N6JD5LA4Func5qhgqEMIvzzy");function rt(r){const{cart:e}=M(),t=e.total,n=Math.abs(t);return He()?o.jsx("section",{className:"container mx-auto py-24",children:o.jsxs("div",{className:"lg:grid lg:grid-cols-5 gap-4 flex flex-col",children:[o.jsx("div",{className:"col-span-2",children:o.jsx(et,{displayTotal:n})}),o.jsx("div",{className:"col-span-3",children:o.jsx(se,{stripe:tt,children:o.jsx(Ze,{})})})]})}):null}const nt=Object.freeze(Object.defineProperty({__proto__:null,Page:rt},Symbol.toStringTag,{value:"Module"})),it={onBeforeRenderEnv:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:null}},dataEnv:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:null}},hydrationCanBeAborted:{type:"standard",definedAtData:{filePathToShowToUser:"/renderer/+config.js",fileExportPathToShowToUser:["default","hydrationCanBeAborted"]},valueSerialized:{type:"js-serialized",value:!0}},onPageTransitionEnd:{type:"standard",definedAtData:{filePathToShowToUser:"/renderer/+onPageTransitionEnd.js",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:je}},onPageTransitionStart:{type:"standard",definedAtData:{filePathToShowToUser:"/renderer/+onPageTransitionStart.js",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:Ee}},onRenderClient:{type:"standard",definedAtData:{filePathToShowToUser:"/renderer/+onRenderClient.jsx",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:we}},title:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/+config.js",fileExportPathToShowToUser:["default","title"]},valueSerialized:{type:"js-serialized",value:"Bloomify"}},Page:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/checkout/+Page.jsx",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:nt}}};export{it as configValuesSerialized};
